---
layout:     post
title:      以太坊基础
subtitle:   本文使关于以太坊的一些基础知识，不定时更新
date:       2019-3-6
author:     gxkyrftx
header-img: img/post-bg-miui-ux.jpg
catalog: true
tags:
    - 区块链
    - 密码学
---
# 0.前言
本文为区块链的学习笔记，主要参考来源为北京大学肖臻老师《区块链技术与应用》公开课的比特币部分,链接<https://www.bilibili.com/video/av37065233/?p=14>这门公开课使我获益匪浅，非常感谢老师的讲授!

以太坊（Ethereum）是一个开源的有智能合约功能的公共区块链平台，通过其专用加密货币以太币（Ether）提供去中心化的以太虚拟机（Ethereum Virtual Machine）来处理点对点合约。

# 1.以太坊概述
以太坊是基于ghost协议的平台，其使用的加密货币以太币，是比特币的升级版。以太币相较于比特币，出块时间短，mining puzzle不是基于算力，而是基于内存（memory，hard），限制了ASIC芯片的使用，使用权益证明（proof of work）替代工作量证明（proof of work），增加了对于智能合约(smart contract)的支持。
比特币出现后，作为一种去中心化的货币，他替代了中心化机构银行的职能，还有一些中心化机构的职能也可以被替代，例如简单逻辑结构的合同仲裁，于是就有了智能合约。当合同方来自世界各地，法律约束将会很复杂，不在同一个司法管辖权之内。即使在同一个司法管辖权内，司法程序也很复杂。而通过智能合约的方式，将规则事先写入，通过程序执行就会很简单。

# 2.基于账户的模式
以太坊基于账户模型（account-based ledger），在系统中显式记录账户余额，不像比特币需要通过UTXO计算。自然防范双花攻击，因为是基于账户余额的。但是无法防范重放攻击（replay attack），收钱的人不诚实，相让付款方重新转。如何防范重放攻击？通过增加nonce，将每个账户的交易编号，并写入每一笔交易，用私钥签名。每次增加一笔交易，nonce+1.

以太坊中两类账户，外部账户（externally owned account）和内部账户。外部账户也叫普通账户，公私钥对控制，有账户余额（balance），nonce。内部账户也叫合约账户（smart contract account），有balance，nonce，合约账户不能主动发起交易，外部账户可以调用合约账户，使这个账户调用另一个合约账户。合约账户有代码（code），相关状态存储（storage），调用的时候使调用地址。

为什么设置这种模型？比特币匿名性强，但是以太坊是需要支持智能合约的，对身份有要求，需要一个相对固定的身份。

# 3.以太坊中的数据结构
基于账户的模式，他的数据结构首先要完成从地址（address）到状态（state）的映射。以太坊中的地址，是160位，将其表示为40个十六进制的数。状态就是外部账户和合约账户的状态。